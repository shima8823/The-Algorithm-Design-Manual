多項式P(x) = anxn + an−1xn−1 + ··· + a1x + a0 の値を計算する次のアルゴリズムの正しさを証明せよ.

Horner(a, x)
        p = a[n]
        for i from n − 1 to 0
                p = p * x + a[i]
        return p

a = {1, 2, 3, 4}
n = 3
x = 2
P(3) = a[3] * (x^3) + a[2] * (x^2) + a[1] * x + a[0]
     = 32 + 12 + 4 + 1
     = 49

p = 4
p = 4 * 2 + 3
  = 11

p = 11 * 2 + 2
  = 24

p = 24 * 2 + 1
  = 49

p = 4           = a[n] * x^0
p = 4 * 2 + 3   = (a[n] * x^0) * x + a[n-1]
  = 11

p = 11 * 2 + 2  = (a[n] * x + a[n-1]) * x + a[n-2]
  = 24          = (a[n] * x^2) + (a[n-1] * x^1) + a[n-2]

p = 24 * 2 + 1  = ((a[n] * x^2) + (a[n-1] * x^1) + a[n-2]) * x + a[n-3]
  = 49          = (a[n] * x^3) + (a[n-1] * x^2) + (a[n-2] * x^1) + a[n-3]

p = a[n]
for i from n − 1 to 0
        p = p * x + a[i]
return p

i = n-1
p = a[n] * x + a[i]
  = a[n] * x^2 + a[i] * x + a[i-1]
  = a[n] * x^3 + a[i] * x^2 + a[i-1] * x + a[i-2]...
よって
a[n] * x^3 + a[n-1] * x^2 + a[n-2] * x + a[n-3]...
となる。多項式と合っている。


--------------------------------

君が書いたのは証明ではない。観察日記だ。
                        Gemini 3 Pro

--------------------------------

ループ不変条件
Invariant(i) = Sum(a[k] * x^(k - (i+1)) for k from i+1 to n)

- 初期状態
p = a[n] と初期化されている

不変条件
n - 1 = iの初期値
Invariant(n - 1) = a[n] * x*(n - n)
                 = a[n]
よってコードと不変条件の値が一致した。

- イテレーション
i = m の時に不変条件が正しいと仮定すると以下のような値になる。
p_old = Sum(a[k] * x^(k - m - 1) for k from m + 1 to n)
p_newはp_oldにxをかけてa[m]を足す
p_new1 = Sum(a[k] * x^(k - m) for k from m + 1 to n) + a[m]
a[m] =　a[m] * x^0 = a[m] * x^(m-m)
よって
P_new1 = Sum(a[k] * x^(k - m) for k from m to n)

つぎに i = m - 1 の時は
p_new2 = Sum(a[k] * x^(k - m) for k from m to n)
よってp_new1 == p_new2になる。

- 終了
Invariant(-1)
a[k] * x^(k - (-1 + 1)) = a[k] * x^k
Sum(a[k] * x^k for k from 0 to n)
これは元の多項式P(x)そのものである。


- ループ不変条件
多項式のアルゴリズム: Sum(a[k] * x^k for k from 0 to n) 

i = -1
p = a[n]*x^n + ... + a[1]*x^1 + a[0]*x^0
xの次数 = k-0

i = 0
p = a[n]*x^(n-1) + ... + a[1]*x^0
xの次数 = k-1

i = 1
p = a[n]*x^(n-2) + ... + a[2]*x^0
xの次数 = k-2

つまりkの下限は i + 1
i  : k
-1 : 0
0  : -1
1  : -2

指数 = k - (i + 1)